import{j as e,aE as L,m as me,q as ge,D as fe,o as xe,p as be,s as je,O as ve,r as u,S as ye,b as we,aF as O,aG as V,t as K,aH as Se,aI as Ne,aJ as _e}from"./vendor-Oy3yQvpb.js";import{r as B,e as F,b as Ce,u as z,N as Re,O as qe,f as ke,R as Pe,L as S}from"./vendor-router-BOglXYhN.js";import{c as _,a as De,b as Me,u as Te,d as Ae,P as Ee}from"./vendor-redux-BIS1gR2s.js";import{b as Ie,s as N,l as R,m as Le,r as Oe,n as ze,F as $e,R as Be,A as Fe,c as d,B as Q,o as Ue,p as Ke,D as W,q as Y,t as X,v as J,d as He,w as Ge,S as Ve,a as Qe,M as We,T as Ye}from"./page-auth-p4-fr_Oe.js";import{e as q,m as k,a as $,b as P,p as D,t as M,r as T,c as A,s as E,u as Z,T as Xe,d as Je,f as Ze,g as et,A as tt,h as at,i as st,D as rt,j as nt,k as it,l as ot,n as dt,S as lt,M as ct,E as ut,P as pt,o as ht,R as mt,C as gt,U as ft,q as xt,v as bt,w as jt,x as vt}from"./page-crm-kIa1ysON.js";import{X as yt,n as wt,o as St,p as Nt,q as _t,T as Ct,a as Rt,r as ee,j as qt,s as te}from"./vendor-ui-Dq0BlLGN.js";import{E as kt}from"./page-error-CxPdqW8p.js";import{A as Pt}from"./page-account-C3M0tmcp.js";import"./vendor-date-fns-BWtotJsy.js";import"./vendor-libphonenumber-js-1k7QeoIm.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const Dt={contract:null,changes:{},isCompleted:{1:!1,2:!1,3:!1,4:!1,5:!1},isEnabled:{1:!0,2:!1,3:!1,4:!1,5:!1},activeStep:1},ae=_({name:"contract",initialState:Dt,reducers:{setContract(t,a){var o,i,c,x,h,b,v;t.contract={...t.contract,...a.payload},t.isCompleted={1:!!((o=t.contract)!=null&&o.terms_signature),2:!!((i=t.contract)!=null&&i.declaration_value_signature),3:!!((c=t.contract)!=null&&c.start_time_signature)&&!!((x=t.contract)!=null&&x.end_time_signature),4:!!((h=t.contract)!=null&&h.payment_signature),5:!!((b=t.contract)!=null&&b.final_signature)&&!!((v=t.contract)!=null&&v.foreman_signature)},t.activeStep=Object.keys(t.isCompleted).findIndex(m=>!t.isCompleted[parseInt(m)])+1;const s={1:["terms_signature"],2:["declaration_value_signature"],3:["start_time_signature","end_time_signature"],4:["payment_signature"],5:["final_signature","foreman_signature"]},n=t.contract,r=m=>{const f=m-1;return f===0?!0:s[f].every(w=>!!n[w])};t.isEnabled=Object.keys(s).reduce((m,f)=>(m[parseInt(f)]=r(parseInt(f)),m),{})},updateContractField:(t,a)=>{t.changes={...t.changes,...a.payload}},resetChanges(t){t.changes={}},setActiveStep(t,a){t.activeStep=a.payload}}}),Mt=ae.reducer,{setContract:Ya,setActiveStep:Xa,updateContractField:Ja,resetChanges:Za}=ae.actions,Tt=new Date;Tt.setHours(0,0,0,0);const At={selectedDate:new Date().toISOString(),selectedRequest:null,open:!1,parklotRequests:null},se=_({name:"parklot",initialState:At,reducers:{setSelectedDate(t,a){t.selectedDate=a.payload},setSelectedRequest:(t,a)=>{t.selectedRequest=a.payload},setOpen:(t,a)=>{t.open=a.payload},setParklotRequests:(t,a)=>{t.parklotRequests=a.payload},updateParklotRequest:(t,a)=>{var s;t.parklotRequests=((s=t.parklotRequests)==null?void 0:s.map(n=>n.id===a.payload.id?{...n,...a.payload}:n))??null}}}),Et=se.reducer,{setSelectedDate:es,setSelectedRequest:ts,setOpen:as,setParklotRequests:ss,updateParklotRequest:rs}=se.actions,It={request:null,changes:{},hasChanges:!1,parklotRequests:null},re=_({name:"request",initialState:It,reducers:{setRequest(t,a){t.request={...t.request,...a.payload}},updateField:(t,a)=>{t.changes={...t.changes,...a.payload},t.hasChanges=!!Object.keys(t.changes).length},resetChanges(t){t.changes={},t.hasChanges=!1},setParklotRequests:(t,a)=>{t.parklotRequests=a.payload}}}),Lt=re.reducer,{setRequest:Ot,updateField:ns,resetChanges:is}=re.actions,zt={filter:"pending",page:1},ne=_({name:"auth",initialState:zt,reducers:{setFilter(t,a){t.filter=a.payload},setPage(t,a){t.page=a.payload}}}),{setFilter:os,setPage:ds}=ne.actions,$t=ne.reducer,Bt={currentModal:null,open:!1},ie=_({name:"modal",initialState:Bt,reducers:{openModal:(t,a)=>{t.currentModal=a.payload,t.open=!0},closeModal:t=>{t.currentModal=null,t.open=!1}}}),{openModal:ls,closeModal:Ft}=ie.actions,Ut=ie.reducer,I=De({reducerPath:"requestsApi",baseQuery:Ie,tagTypes:["Request","StatusCounts"],endpoints:t=>({getRequests:t.query({query:({filter:a,page:s})=>a&&s?`/requests?filter=${a}&page=${s}`:"/requests",providesTags(a){return a?[...a.requests.map(({id:s})=>({type:"Request",id:s})),{type:"Request",id:"LIST"}]:[{type:"Request",id:"LIST"}]}}),getStatusCounts:t.query({query:()=>"/requests/status_counts",providesTags:()=>[{type:"StatusCounts"}]}),getRequestById:t.query({query:({id:a})=>`/requests/${a}`,async onQueryStarted(a,{queryFulfilled:s,dispatch:n}){try{const r=await s;n(Ot(r.data)),console.log("result",r)}catch(r){console.log("error",r)}},providesTags:(a,s,{id:n})=>[{type:"Request",id:n}]}),updateRequest:t.mutation({query:({id:a,data:s})=>({url:`/requests/${a}`,method:"PUT",body:{request:s}}),invalidatesTags:[{type:"Request",id:"LIST"},{type:"StatusCounts"}]}),createRequest:t.mutation({query:a=>({url:"/requests",method:"POST",body:a}),invalidatesTags:[{type:"Request",id:"LIST"}]}),createCustomer:t.mutation({query:a=>({url:"/users",method:"POST",body:{user:{...a,password:window.crypto.randomUUID()}}})}),updateCustomer:t.mutation({query:({id:a,data:s})=>({url:`/users/${a}`,method:"PUT",body:{user:s}})})})}),{useCreateRequestMutation:Kt}=I,g=Me({reducer:{auth:Le,contract:Mt,parklot:Et,request:Lt,requests:$t,modal:Ut,[R.reducerPath]:R.reducer,[I.reducerPath]:I.reducer,[E.reducerPath]:E.reducer,[A.reducerPath]:A.reducer,[T.reducerPath]:T.reducer,[M.reducerPath]:M.reducer,[D.reducerPath]:D.reducer,[P.reducerPath]:P.reducer,[$.reducerPath]:$.reducer,[N.reducerPath]:N.reducer,[k.reducerPath]:k.reducer,[q.reducerPath]:q.reducer},middleware:t=>t().concat(Oe,R.middleware,I.middleware,E.middleware,A.middleware,T.middleware,M.middleware,D.middleware,P.middleware,$.middleware,N.middleware,k.middleware,q.middleware)}),U=Te.withTypes(),Ht=Ae.withTypes();function oe(){return e.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:e.jsx("p",{children:"Global Loading..."})})}const Gt=async()=>{g.dispatch(N.util.prefetch("getSettings",void 0,{force:!0}));const{user:t}=g.getState().auth;return L.get("session_id")||t?B("/"):null},Vt=async()=>{if(g.dispatch(N.util.prefetch("getSettings",void 0,{force:!0})),!L.get("session_id"))return B("/auth/login");const a=await g.dispatch(R.endpoints.verify.initiate());return a.error?(L.remove("session_id"),B("/auth/login")):(a.data&&Qt(),null)};async function Qt(){g.dispatch(E.endpoints.getServices.initiate()).unwrap(),g.dispatch(T.endpoints.getRates.initiate()).unwrap(),g.dispatch(A.endpoints.getCalendarRates.initiate()).unwrap(),g.dispatch(M.endpoints.getTrucks.initiate()).unwrap(),g.dispatch(D.endpoints.getPackings.initiate()).unwrap(),g.dispatch(P.endpoints.getExtraServices.initiate()),g.dispatch(k.endpoints.getMoveSizes.initiate()).unwrap(),g.dispatch(q.endpoints.getEntranceTypes.initiate()).unwrap()}const Wt=[{path:"auth",element:e.jsx(Fe,{}),loader:Gt,hydrateFallbackElement:e.jsx(oe,{}),children:[{index:!0,element:e.jsx(F,{to:"/auth/login"})},{path:"login",element:e.jsx(ze,{})},{path:"forgot-password",element:e.jsx($e,{})},{path:"reset-password",element:e.jsx(Be,{})}]}];function Yt({...t}){return e.jsx(me,{"data-slot":"sheet",...t})}function Xt({...t}){return e.jsx(je,{"data-slot":"sheet-portal",...t})}function Jt({className:t,...a}){return e.jsx(ve,{"data-slot":"sheet-overlay",className:d("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",t),...a})}function Zt({className:t,children:a,side:s="right",...n}){return e.jsxs(Xt,{children:[e.jsx(Jt,{}),e.jsxs(xe,{"data-slot":"sheet-content",className:d("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",s==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",s==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",s==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",s==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...n,children:[a,e.jsxs(be,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[e.jsx(yt,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ea({className:t,...a}){return e.jsx("div",{"data-slot":"sheet-header",className:d("flex flex-col gap-1.5 p-4",t),...a})}function ta({className:t,...a}){return e.jsx(ge,{"data-slot":"sheet-title",className:d("text-foreground font-semibold",t),...a})}function aa({className:t,...a}){return e.jsx(fe,{"data-slot":"sheet-description",className:d("text-muted-foreground text-sm",t),...a})}const sa="sidebar_state",ra=60*60*24*7,na="16rem",ia="18rem",oa="3rem",da="b",de=u.createContext(null);function C(){const t=u.useContext(de);if(!t)throw new Error("useSidebar must be used within a SidebarProvider.");return t}function la({defaultOpen:t=!0,open:a,onOpenChange:s,className:n,style:r,children:o,...i}){const c=Z(),[x,h]=u.useState(!1),[b,v]=u.useState(t),m=a??b,f=u.useCallback(l=>{const j=typeof l=="function"?l(m):l;s?s(j):v(j),document.cookie=`${sa}=${j}; path=/; max-age=${ra}`},[s,m]),y=u.useCallback(()=>c?h(l=>!l):f(l=>!l),[c,f,h]);u.useEffect(()=>{const l=j=>{j.key===da&&(j.metaKey||j.ctrlKey)&&(j.preventDefault(),y())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[y]);const w=m?"expanded":"collapsed",p=u.useMemo(()=>({state:w,open:m,setOpen:f,isMobile:c,openMobile:x,setOpenMobile:h,toggleSidebar:y}),[w,m,f,c,x,h,y]);return e.jsx(de.Provider,{value:p,children:e.jsx(Xe,{delayDuration:0,children:e.jsx("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":na,"--sidebar-width-icon":oa,...r},className:d("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",n),...i,children:o})})})}function ca({side:t="left",variant:a="sidebar",collapsible:s="offcanvas",className:n,children:r,...o}){const{isMobile:i,state:c,openMobile:x,setOpenMobile:h}=C();return s==="none"?e.jsx("div",{"data-slot":"sidebar",className:d("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",n),...o,children:r}):i?e.jsxs(Yt,{open:x,onOpenChange:h,...o,children:[e.jsxs(ea,{className:"sr-only",children:[e.jsx(ta,{children:"Sidebar"}),e.jsx(aa,{children:"Displays the mobile sidebar."})]}),e.jsx(Zt,{"data-sidebar":"sidebar","data-slot":"sidebar","data-mobile":"true",className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden",style:{"--sidebar-width":ia},side:t,children:e.jsx("div",{className:"flex h-full w-full flex-col",children:r})})]}):e.jsxs("div",{className:"group peer text-sidebar-foreground hidden md:block","data-state":c,"data-collapsible":c==="collapsed"?s:"","data-variant":a,"data-side":t,"data-slot":"sidebar",children:[e.jsx("div",{className:d("relative h-svh w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",a==="floating"||a==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)")}),e.jsx("div",{className:d("fixed inset-y-0 z-10 hidden h-svh w-(--sidebar-width) transition-[left,right,width] duration-200 ease-linear md:flex",t==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",a==="floating"||a==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon) group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...o,children:e.jsx("div",{"data-sidebar":"sidebar",className:"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm",children:r})})]})}function ua({className:t,onClick:a,...s}){const{toggleSidebar:n}=C();return e.jsxs(Q,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:d("",t),onClick:r=>{a==null||a(r),n()},...s,children:[e.jsx(wt,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function pa({className:t,...a}){const{toggleSidebar:s}=C();return e.jsx("button",{"data-sidebar":"rail","data-slot":"sidebar-rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:s,title:"Toggle Sidebar",className:d("hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",t),...a})}function ha({className:t,...a}){return e.jsx("main",{"data-slot":"sidebar-inset",className:d("bg-background relative flex min-h-svh flex-1 flex-col","peer-data-[variant=inset]:min-h-[calc(100svh-(--spacing(4)))] md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",t),...a})}function ma({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-header","data-sidebar":"header",className:d("flex flex-col gap-2 p-2",t),...a})}function ga({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-footer","data-sidebar":"footer",className:d("flex flex-col gap-2 p-2",t),...a})}function fa({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-content","data-sidebar":"content",className:d("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...a})}function xa({className:t,...a}){return e.jsx("div",{"data-slot":"sidebar-group","data-sidebar":"group",className:d("relative flex w-full min-w-0 flex-col p-2",t),...a})}function le({className:t,...a}){return e.jsx("ul",{"data-slot":"sidebar-menu","data-sidebar":"menu",className:d("flex w-full min-w-0 flex-col gap-1",t),...a})}function ce({className:t,...a}){return e.jsx("li",{"data-slot":"sidebar-menu-item","data-sidebar":"menu-item",className:d("group/menu-item relative",t),...a})}const ba=we("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function ue({asChild:t=!1,isActive:a=!1,variant:s="default",size:n="default",tooltip:r,className:o,...i}){const c=t?ye:"button",{isMobile:x,state:h}=C(),b=e.jsx(c,{"data-slot":"sidebar-menu-button","data-sidebar":"menu-button","data-size":n,"data-active":a,className:d(ba({variant:s,size:n}),o),...i});return r?(typeof r=="string"&&(r={children:r}),e.jsxs(Je,{children:[e.jsx(Ze,{asChild:!0,children:b}),e.jsx(et,{side:"right",align:"center",hidden:h!=="collapsed"||x,...r})]})):b}function ja({items:t}){const a=Ce(),{setOpenMobile:s,isMobile:n}=C(),r=z();function o(i){n&&s(!1),r(i,{replace:!0})}return e.jsx(xa,{children:e.jsx(le,{children:t.map(i=>e.jsx(ce,{children:e.jsxs(ue,{tooltip:i.title,isActive:a.pathname===`/crm/${i.url}`,onClick:()=>o(i.url),children:[i.icon&&e.jsx(i.icon,{}),e.jsx("span",{children:i.title})]})},i.title))})})}const va=()=>{const t=U(Ue);return u.useMemo(()=>({user:t}),[t])};function H(){const{user:t}=va(),a=z(),[s,{isLoading:n}]=Ke();return e.jsx(le,{children:e.jsx(ce,{children:e.jsxs(W,{modal:!1,children:[e.jsx(Y,{asChild:!0,children:e.jsxs(ue,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[e.jsx(tt,{className:"h-8 w-8 rounded-md",children:e.jsxs(at,{className:"rounded-md bg-foreground text-background",children:[t==null?void 0:t.first_name[0],t==null?void 0:t.last_name[0]]})}),e.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight",children:[e.jsxs("span",{className:"truncate font-semibold",children:[t==null?void 0:t.first_name," ",t==null?void 0:t.last_name]}),e.jsx("span",{className:"truncate text-xs",children:t==null?void 0:t.email_address})]}),e.jsx(St,{className:"ml-auto size-4"})]})}),e.jsx(X,{align:"end",sideOffset:4,children:e.jsxs(J,{onClick:async()=>{await s().unwrap(),a("/auth/login")},disabled:n,children:[e.jsx(Nt,{}),"Log out"]})})]})})})}const ya=[{title:"Requests",url:"requests",icon:_t},{title:"Dispatch",url:"dispatch",icon:Ct},{title:"Settings",url:"settings",icon:Rt},{title:"Messages",url:"messages",icon:ee}];function wa({...t}){return e.jsxs(ca,{collapsible:"icon",...t,children:[e.jsx(ma,{children:e.jsx(H,{})}),e.jsx(fa,{children:e.jsx(ja,{items:ya})}),e.jsx(ga,{children:e.jsx(H,{})}),e.jsx(pa,{})]})}function Sa(){const t=z(),[a,{isLoading:s}]=Kt(),{data:n}=st(),r=n==null?void 0:n.filter(i=>i.enabled);async function o(i){const c=await a({service_id:i}).unwrap();t(`/dashboard/requests/${c.id}`)}return e.jsxs(W,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(He,{loading:s,disabled:s||(r==null?void 0:r.length)===0,children:e.jsxs("span",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"hidden md:inline-flex",children:"Create Request"}),e.jsx("span",{className:"inline-flex md:hidden",children:"New"}),e.jsx(qt,{className:"size-5"})]})})}),e.jsx(X,{className:"w-56",children:e.jsx(Ge,{children:r==null?void 0:r.map((i,c)=>e.jsx(J,{className:"cursor-pointer",onClick:()=>o(i.id),children:i.name},c))})})]})}function Na({className:t,...a}){return e.jsx(O,{"data-slot":"command",className:d("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",t),...a})}function _a({title:t="Command Palette",description:a="Search for a command to run...",children:s,...n}){return e.jsxs(rt,{...n,children:[e.jsxs(nt,{className:"sr-only",children:[e.jsx(it,{children:t}),e.jsx(ot,{children:a})]}),e.jsx(dt,{className:"overflow-hidden p-0",children:e.jsx(Na,{className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})})]})}function Ca({className:t,isLoading:a,...s}){return e.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[a?e.jsx(Ve,{className:"size-4 shrink-0 opacity-50"}):e.jsx(te,{className:"size-4 shrink-0 opacity-50"}),e.jsx(O.Input,{"data-slot":"command-input",className:d("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",t),...s})]})}function Ra({className:t,...a}){return e.jsx(O.List,{"data-slot":"command-list",className:d("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",t),...a})}function G({...t}){return e.jsx(O.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...t})}const pe=V.create({baseURL:"http://localhost:3001/api/v1",withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});pe.interceptors.response.use(t=>t,t=>{var a,s;if(V.isAxiosError(t)){const n=((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.error)||"An unexpected error occurred.";K.error(n)}else K.error("Network error. Please try again.");return Promise.reject(t)});const qa=500,ka="k",Pa=({item:t,onSelect:a})=>e.jsx("div",{className:"cursor-pointer px-4 py-2 text-sm transition-colors hover:bg-muted",onClick:a,children:Object.keys(t.data).map(s=>{const n=t.data[s],r=t.highlighting[s];return e.jsxs("div",{className:"grid grid-cols-[7rem_1fr] items-center leading-6",children:[e.jsxs("span",{className:"capitalize text-muted-foreground",children:[s.replace("_"," "),":"]}),r?e.jsx("span",{dangerouslySetInnerHTML:{__html:r}}):e.jsx("span",{children:n})]},s)})});function Da(){const t=z(),a=Z(),[s,n]=u.useState(!1),[r,o]=u.useState(""),[i,c]=u.useState([]),[x,h]=u.useState(!1),[b,v]=u.useState(null),m=u.useCallback(async p=>{if(!p.trim()){c([]),h(!1);return}try{const l=await pe.get(`/search?query=${encodeURIComponent(p)}`);c(l.data),v(null)}catch(l){console.error(l),c([]),v("Failed to fetch search results")}finally{h(!1)}},[]),f=u.useCallback(Se(qa,m,{atBegin:!1}),[m]),y=p=>{h(!0),o(p),f(p)},w=p=>{n(!1),t(`/dashboard/requests/${p}`)};return u.useEffect(()=>{const p=l=>{l.key===ka&&(l.metaKey||l.ctrlKey)&&(l.preventDefault(),n(j=>!j))};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(Q,{onClick:()=>n(!0),variant:"outline",size:a?"icon":"default",children:[e.jsx(te,{}),e.jsx("span",{className:"hidden md:block",children:"Search anything..."}),e.jsxs("kbd",{className:"pointer-events-none hidden h-5 select-none items-center gap-0.5 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium text-muted-foreground opacity-100 md:flex",children:[e.jsx("span",{className:"text-xs",children:"⌘"}),"K"]})]}),e.jsxs(_a,{open:s,onOpenChange:n,children:[e.jsx(Ca,{isLoading:x,placeholder:"Search anything",value:r,onValueChange:y}),e.jsxs(Ra,{className:"max-h-[470px]",children:[b&&e.jsx(G,{children:b}),!b&&i.length<1&&e.jsx(G,{children:"No results found."}),e.jsx("div",{className:"divide-y",children:i.map((p,l)=>e.jsx(Pa,{item:p,onSelect:()=>w(p.data.id)},`${p.data.id}-${l}`))})]})]})]})}function Ma(){return e.jsx("div",{className:"relative",children:e.jsxs(Re,{to:"/crm/messages",className:({isActive:t})=>d(Qe({variant:t?"secondary":"outline",size:"icon"})),children:[e.jsx(ee,{}),e.jsx("span",{className:"sr-only",children:"Messages"})]})})}function he(){const t=L.get("sidebar_state")!=="false";return e.jsxs(la,{defaultOpen:t,children:[e.jsx(wa,{}),e.jsx(Ta,{})]})}function Ta(){return e.jsxs(ha,{children:[e.jsx("header",{className:"z-50 flex h-16 w-full items-center border-b bg-background px-4",children:e.jsxs("div",{className:"flex w-full justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ua,{className:"-ml-1"}),e.jsx(lt,{orientation:"vertical",className:"mr-2 h-4"}),e.jsx(Sa,{}),e.jsx(Da,{})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ma,{}),e.jsx(We,{})]})]})}),e.jsx("div",{className:"h-[calc(100svh-4rem)] overflow-hidden",children:e.jsx(qe,{})})]})}function Aa({allowedRoles:t,children:a}){const s=U(n=>n.auth.user);return s&&t.includes(s.role)?a:e.jsx(F,{to:"/auth/login",replace:!0})}const Ea={path:"/crm",loader:Vt,element:e.jsx(Aa,{allowedRoles:["admin","manager"],children:e.jsx(he,{})}),hydrateFallbackElement:e.jsx(oe,{}),children:[{index:!0,element:e.jsx(F,{to:"/crm/requests",replace:!0})},{path:"requests",element:e.jsx("div",{children:"Requests"})},{path:"dispatch",element:e.jsx("div",{children:"Dispatch"})},{path:"settings",element:e.jsx(vt,{}),children:[{path:"services",element:e.jsx(ct,{})},{path:"extra-services",element:e.jsx(ut,{})},{path:"packing",element:e.jsx(pt,{})},{path:"trucks",element:e.jsx(ht,{})},{path:"rates",element:e.jsx(mt,{})},{path:"calendar-rates",element:e.jsx(gt,{})},{path:"department",element:e.jsx(xt,{}),children:[{path:":id",element:e.jsx(ft,{})}]},{path:"company",element:e.jsx(bt,{})},{path:"calculator",element:e.jsx(jt,{})}]},{path:"messages",element:e.jsx("div",{children:"Messages"})}]},Ia={editDeposit:()=>e.jsx("div",{children:"edit deposit"}),editMoveSize:()=>e.jsx("div",{children:"edit deposit"}),editPacking:()=>e.jsx("div",{children:"edit deposit"}),extraStop:()=>e.jsx("div",{children:"edit deposit"}),closeRequest:()=>e.jsx("div",{children:"edit deposit"})};function La(){const t=Ht(),{currentModal:a}=U(r=>r.modal),s=()=>{t(Ft())};if(!a)return null;const n=Ia[a];return n?e.jsx(n,{onClose:s}):null}const Oa=ke([{path:"/",element:e.jsxs("div",{className:"flex flex-col gap-10",children:["Hello world!",e.jsx(S,{to:"/auth/login",children:"Login"}),e.jsx(S,{to:"/crm",children:"crm"}),e.jsx(S,{to:"/account",children:"account"}),e.jsx(S,{to:"/testing",children:"testing"}),e.jsx(S,{to:"/schedule",children:"schedule"})]}),errorElement:e.jsx(kt,{})},{path:"/account",element:e.jsx(Pt,{})},{path:"/crm",element:e.jsx(he,{})},...Wt,Ea]);function za(){return e.jsx(Ee,{store:g,children:e.jsxs(Ye,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:[e.jsx(Pe,{router:Oa}),e.jsx(Ne,{position:"top-center",richColors:!0}),e.jsx(La,{})]})})}_e.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(za,{})}));
